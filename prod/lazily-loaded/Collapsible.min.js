(()=>{var h=Object.defineProperty;var l=(i,t,s)=>t in i?h(i,t,{enumerable:!0,configurable:!0,writable:!0,value:s}):i[t]=s;var o=(i,t,s)=>(l(i,typeof t!="symbol"?t+"":t,s),s);var n=class{static getSiblings(t){return Array.prototype.filter.call(t.parentNode.children,function(s){return s!==t})}static setStyles(t,s){Object.entries(s).forEach(([e,r])=>{t.style[e]=r})}static parseFrames(t){return JSON.parse(t).filter(s=>s)}static supportsHover(){return window.matchMedia("(hover: none)").matches}static triggerCallback(t,s,e){s&&e.forEach(r=>{r.call(t)})}static toggleAnimPlayback(t){t.updatePlaybackRate(t.playbackRate*=-1),t.play()}constructor(t){this.node=t.node,this.trigger=this.node.querySelector(this.constructor.classes.trigger),this.menu=this.node.querySelector(this.constructor.classes.menu),this.inner=this.node.querySelector(this.constructor.classes.inner),this.isInAccordion=this.node.parentElement.classList.contains(this.constructor.classes.accordion),this.accordion=this.isInAccordion?this.node.parentElement:null,this.siblings=[],this.easing=this.accordion?.dataset?.easing||this.node?.dataset?.easing||"ease-in-out",this.duration=+this.accordion?.dataset?.duration||+this.node?.dataset?.duration||300,this.initiallyOpen=this.node.dataset.hasOwnProperty("initiallyOpen"),this.closeOnOutsideClick=this.node.dataset.hasOwnProperty("closeOnOutsideClick"),this.anim=this.menu.animate(this.setFrames(),{easing:this.easing,duration:this.duration,fill:"both",direction:this.initiallyOpen?"reverse":"normal"}),this.hoverTrigger=this.node.dataset.hasOwnProperty("hoverTrigger"),this.node.closeSelf=this.close.bind(this),this.hasCustomKeyframes=this.node.dataset.hasOwnProperty("keyframes"),!this.isInAccordion&&this.hasCustomKeyframes&&(this.passedFrames=this.constructor.parseFrames(this.node.dataset.keyframes)),this.init()}setFrames(){return this.hasCustomKeyframes?this.passedFrames:[{height:"0"},{height:`${this.inner.scrollHeight}px`}]}toggle(){if(this.anim.effect.setKeyframes(this.setFrames()),this.node.classList.remove(this.constructor.classes.active,this.constructor.classes.in,this.constructor.classes.out),this.node.classList.add(this.constructor.classes.transition),this.anim.playbackRate===1){this.node.classList.add(this.initiallyOpen?this.constructor.classes.out:this.constructor.classes.in),this.constructor.toggleAnimPlayback(this.anim);return}this.node.classList.add(this.initiallyOpen?this.constructor.classes.in:this.constructor.classes.out),this.constructor.toggleAnimPlayback(this.anim)}onMouseEnter(){this.constructor.triggerCallback(this,this.anim.playbackRate!=1,[this.toggle,this.handleAccordion])}onClick(){this.constructor.triggerCallback(this,!0,[this.toggle,this.handleAccordion])}close(){this.anim.effect.setKeyframes(this.setFrames()),this.node.classList.remove(this.constructor.classes.in),[this.constructor.classes.active,this.constructor.classes.out].some(t=>this.node.classList.contains(t))&&(this.node.classList.remove(this.constructor.classes.active,this.constructor.classes.out),this.node.classList.add(this.constructor.classes.transition,this.constructor.classes.in),this.constructor.toggleAnimPlayback(this.anim))}handleAccordion(){this.isInAccordion&&this.accordion.dataset.hasOwnProperty("collapseSiblings")&&this.siblings.forEach(t=>{t.closeSelf()})}initEvents(){if(this.anim.addEventListener("finish",t=>{if(this.initiallyOpen){this.onFinish(t);return}this.onFinish(t,!1)}),this.isInAccordion||this.constructor.supportsHover()||!this.hoverTrigger){this.trigger.addEventListener("click",this.onClick.bind(this));return}this.trigger.addEventListener("mouseover",this.onMouseEnter.bind(this)),this.node.addEventListener("mouseleave",this.close.bind(this))}setStartState(){if(this.hasCustomKeyframes){this.constructor.setStyles(this.menu,this.passedFrames[0]);return}this.constructor.setStyles(this.menu,{height:"0px"})}setEndState(){if(this.hasCustomKeyframes){this.constructor.setStyles(this.menu,this.passedFrames[this.passedFrames.length-1]);return}this.constructor.setStyles(this.menu,{height:"auto"})}onFinish(t,s=!0){if(this.anim.cancel(),this.node.classList.remove(this.constructor.classes.transition,this.constructor.classes.in,this.constructor.classes.out),t.target.playbackRate*(s?1:-1)>0){this.node.classList.remove(this.constructor.classes.active),this.trigger.setAttribute("aria-expanded",!1),this.setStartState();return}this.node.classList.add(this.constructor.classes.active),this.trigger.setAttribute("aria-expanded",!0),this.setEndState()}stopPropagationInTrigger(){let t=this.trigger.querySelector("a");!t||t.addEventListener("click",s=>{s.stopPropagation()})}init(){if(this.anim.playbackRate*=-1,this.anim.cancel(),this.initEvents(),this.isInAccordion&&this.siblings.push(...this.constructor.getSiblings(this.node)),this.node.style.setProperty("--collapsible-duration",`${this.duration/1e3}s`),this.stopPropagationInTrigger(),this.initiallyOpen){this.node.classList.add(this.constructor.classes.active),this.trigger.setAttribute("aria-expanded",!0),this.setEndState();return}else this.trigger.setAttribute("aria-expanded",!1);this.setStartState()}};o(n,"classes",{active:"active",transition:"transition",in:"transition-backwards",out:"transition-forwards",selectPicked:"picked",accordion:"accordion",selectOption:".collapsible__option",selectCurrent:".collapsible__select-current",trigger:".collapsible__trigger",menu:".collapsible__content",inner:".collapsible__content__inner"});var a=class extends n{static setSelectCurrent(t,s,e){t.textContent=s.textContent,s.dataset.hasOwnProperty("value")&&e.setAttribute("data-value",s.dataset.value)}constructor({node:t}){super({node:t}),this.initSelect()}initSelect(){let t=this.node.querySelectorAll(this.constructor.classes.selectOption),s=this.trigger.querySelector(this.constructor.classes.selectCurrent);t.forEach(e=>{e.classList.contains(this.constructor.classes.selectPicked)&&this.constructor.setSelectCurrent(s,e,this.node),e.addEventListener("click",()=>{this.constructor.getSiblings(e).forEach(r=>{r.classList.remove(this.constructor.classes.selectPicked)}),e.classList.add(this.constructor.classes.selectPicked),this.constructor.setSelectCurrent(s,e,this.node),this.close()})})}},c=class{constructor(){this.nodes=document.querySelectorAll(".collapsible"),this.nodes&&(this.collapsibles=[],this.init())}initEvents(){window.addEventListener("resize",()=>{this.collapsibles.forEach(t=>{t.anim.effect.setKeyframes(t.setFrames())})}),document.addEventListener("click",t=>{this.collapsibles.forEach(s=>{!s.isInAccordion&&s.closeOnOutsideClick&&!t.composedPath().includes(s.node)&&s.anim.playbackRate>0&&s.toggle()})})}init(){this.nodes.forEach(t=>{t.dataset.hasOwnProperty("select")?this.collapsibles.push(new a({node:t})):this.collapsibles.push(new n({node:t}))}),this.initEvents()}};new c;})();
